<!DOCTYPE html>

<html lang="en" data-content_root="../../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>pyspec.client._motor &#8212; pyspec 0.1 documentation</title><meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=b86133f3" />
    <link rel="stylesheet" type="text/css" href="../../../_static/pydoctheme.css?v=23252803" />
    <link id="pygments_dark_css" media="(prefers-color-scheme: dark)" rel="stylesheet" type="text/css" href="../../../_static/pygments_dark.css?v=5349f25f" />
    
    <script src="../../../_static/documentation_options.js?v=2709fde1"></script>
    <script src="../../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /><link rel="stylesheet" href="../../../_static/pydoctheme_dark.css" media="(prefers-color-scheme: dark)" id="pydoctheme_dark_css">
    <link rel="shortcut icon" type="image/png" href="../../../_static/py.svg" />
            <script type="text/javascript" src="../../../_static/copybutton.js"></script>
            <script type="text/javascript" src="../../../_static/menu.js"></script>
            <script type="text/javascript" src="../../../_static/search-focus.js"></script>
            <script type="text/javascript" src="../../../_static/themetoggle.js"></script> 
  </head>
<body>
<div class="mobile-nav">
    <input type="checkbox" id="menuToggler" class="toggler__input" aria-controls="navigation"
           aria-pressed="false" aria-expanded="false" role="button" aria-label="Menu" />
    <nav class="nav-content" role="navigation">
        <label for="menuToggler" class="toggler__label">
            <span></span>
        </label>
        <span class="nav-items-wrapper">
            <a href="https://www.python.org/" class="nav-logo">
                <img src="../../../_static/py.svg" alt="Python logo"/>
            </a>
            <span class="version_switcher_placeholder"></span>
            <form role="search" class="search" action="../../../search.html" method="get">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" class="search-icon">
                    <path fill-rule="nonzero" fill="currentColor" d="M15.5 14h-.79l-.28-.27a6.5 6.5 0 001.48-5.34c-.47-2.78-2.79-5-5.59-5.34a6.505 6.505 0 00-7.27 7.27c.34 2.8 2.56 5.12 5.34 5.59a6.5 6.5 0 005.34-1.48l.27.28v.79l4.25 4.25c.41.41 1.08.41 1.49 0 .41-.41.41-1.08 0-1.49L15.5 14zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"></path>
                </svg>
                <input placeholder="Quick search" aria-label="Quick search" type="search" name="q" />
                <input type="submit" value="Go"/>
            </form>
        </span>
    </nav>
    <div class="menu-wrapper">
        <nav class="menu" role="navigation" aria-label="main navigation">
            <div class="language_switcher_placeholder"></div>
            
<label class="theme-selector-label">
    Theme
    <select class="theme-selector" oninput="activateTheme(this.value)">
        <option value="auto" selected>Auto</option>
        <option value="light">Light</option>
        <option value="dark">Dark</option>
    </select>
</label>
<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </nav>
    </div>
</div>
  
    <div class="related" role="navigation" aria-label="Related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
          <li><img src="../../../_static/py.svg" alt="Python logo" style="vertical-align: middle; margin-top: -1px"/></li>
          <li><a href="https://www.python.org/">Python</a> &#187;</li>
          <li class="switchers">
            <div class="language_switcher_placeholder"></div>
            <div class="version_switcher_placeholder"></div>
          </li>
          <li>
              
              <a href="../../../index.html">pyspec 0.1 documentation</a> &#187;
              
          </li>
          <li class="nav-item nav-item-1"><a href="../../index.html" accesskey="U">Module code</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">pyspec.client._motor</a></li>
                <li class="right">
                    

    <div class="inline-search" role="search">
        <form class="inline-search" action="../../../search.html" method="get">
          <input placeholder="Quick search" aria-label="Quick search" type="search" name="q" id="search-box" />
          <input type="submit" value="Go" />
        </form>
    </div>
                     |
                </li>
            <li class="right">
<label class="theme-selector-label">
    Theme
    <select class="theme-selector" oninput="activateTheme(this.value)">
        <option value="auto" selected>Auto</option>
        <option value="light">Light</option>
        <option value="dark">Dark</option>
    </select>
</label> |</li>
            
      </ul>
    </div>    

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for pyspec.client._motor</h1><div class="highlight"><pre>
<span></span><span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Literal</span><span class="p">,</span> <span class="n">Optional</span><span class="p">,</span> <span class="n">overload</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pyspec._connection</span><span class="w"> </span><span class="kn">import</span> <span class="n">ClientConnection</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">asyncio</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">._remote_property_table</span><span class="w"> </span><span class="kn">import</span> <span class="n">PropertyGroup</span><span class="p">,</span> <span class="n">RemotePropertyTable</span><span class="p">,</span> <span class="n">WritableProperty</span>


<div class="viewcode-block" id="Motor">
<a class="viewcode-back" href="../../../pyspec.client.html#pyspec.client._motor.Motor">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Motor</span><span class="p">(</span><span class="n">PropertyGroup</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The motor properties are used to control the motors.</span>
<span class="sd">    The parameters for the commands that are sent from the client and the values in the replies and events that are sent from the server are always transmitted as ASCII strings in the data that follows the packet header.</span>

<span class="sd">    Args:</span>
<span class="sd">        motor_name (str): The name of the motor.</span>
<span class="sd">        client_connection (ClientConnection): The client connection instance.</span>
<span class="sd">        remote_property_table (RemotePropertyTable): The remote property table instance.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">motor_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">client_connection</span><span class="p">:</span> <span class="n">ClientConnection</span><span class="p">,</span>
        <span class="n">remote_property_table</span><span class="p">:</span> <span class="n">RemotePropertyTable</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;motor/</span><span class="si">{</span><span class="n">motor_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">remote_property_table</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">motor_name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_client_connection</span> <span class="o">=</span> <span class="n">client_connection</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_remote_property_table</span> <span class="o">=</span> <span class="n">remote_property_table</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">position</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_readonly_property</span><span class="p">(</span><span class="s2">&quot;position&quot;</span><span class="p">,</span> <span class="nb">float</span><span class="p">)</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        motor/{mne}/position</span>
<span class="sd">            on(&quot;change&quot;): Sent when the dial position or user offset changes.</span>
<span class="sd">            get: Returns the current motor position in user units.</span>
<span class="sd">            set: Sets the user offset on the server.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dial_position</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_property</span><span class="p">(</span><span class="s2">&quot;dial_position&quot;</span><span class="p">,</span> <span class="nb">float</span><span class="p">)</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        motor/{mne}/dial_position</span>
<span class="sd">            on(&quot;change&quot;): Sent when the dial position changes.</span>
<span class="sd">            get: Returns the current motor position in dial units.</span>
<span class="sd">            set: Sets the dial position on the server by pushing a</span>

<span class="sd">                .. code-block:: none</span>
<span class="sd">                </span>
<span class="sd">                    set_dial mne data\\n</span>

<span class="sd">                onto the command queue, unless the dial position is already set to that value.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_property</span><span class="p">(</span><span class="s2">&quot;offset&quot;</span><span class="p">,</span> <span class="nb">float</span><span class="p">)</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        motor/{mne}/offset</span>
<span class="sd">            on(&quot;change&quot;): Sent when the offset changes.</span>
<span class="sd">            get: Returns the current user offset in dial units.</span>
<span class="sd">            set: Sets the user offset by pushing the</span>

<span class="sd">                .. code-block:: none</span>
<span class="sd">                </span>
<span class="sd">                    set mne value\\n</span>

<span class="sd">                command onto the command queue, unless the offset is already at the value.</span>
<span class="sd">                The data should contain the offset value in motor units (degrees, mm, etc.).</span>
<span class="sd">                The server will calculate `value` for the argument in `set` appropriately.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">step_size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_readonly_property</span><span class="p">(</span><span class="s2">&quot;step_size&quot;</span><span class="p">,</span> <span class="nb">float</span><span class="p">)</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        motor/{mne}/step_size</span>
<span class="sd">            on(&quot;change&quot;): Sent when the steps-per-unit parameter changes.</span>
<span class="sd">            get: Returns the current steps-per-unit parameter.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sign</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_readonly_property</span><span class="p">(</span><span class="s2">&quot;sign&quot;</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        motor/{mne}/sign</span>
<span class="sd">            on(&quot;change&quot;): Sent when the sign-of-user*dial parameter changes.</span>
<span class="sd">            get: Returns the current sign-of-user*dial parameter.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">moving</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_readonly_property</span><span class="p">(</span><span class="s2">&quot;move_done&quot;</span><span class="p">,</span> <span class="nb">bool</span><span class="p">)</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        motor/{mne}/move_done</span>
<span class="sd">            on(&quot;change&quot;): Sent when moving starts (True) and stops (False).</span>
<span class="sd">            get: True if the motor is busy, otherwise False.</span>

<span class="sd">        Note: This does seem a little backwards from the name of the SPEC prop.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">high_lim_hit</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_readonly_property</span><span class="p">(</span><span class="s2">&quot;high_lim_hit&quot;</span><span class="p">,</span> <span class="nb">bool</span><span class="p">)</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        motor/{mne}/high_lim_hit</span>
<span class="sd">            on(&quot;change&quot;): Sent when the high-limit switch has been hit.</span>
<span class="sd">            get: True if the high-limit switch has been hit.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">low_lim_hit</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_readonly_property</span><span class="p">(</span><span class="s2">&quot;low_lim_hit&quot;</span><span class="p">,</span> <span class="nb">bool</span><span class="p">)</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        motor/{mne}/low_lim_hit</span>
<span class="sd">            on(&quot;change&quot;): Sent when the low-limit switch has been hit.</span>
<span class="sd">            get: True if the low-limit switch has been hit.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">emergency_stop</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_readonly_property</span><span class="p">(</span><span class="s2">&quot;emergency_stop&quot;</span><span class="p">,</span> <span class="nb">bool</span><span class="p">)</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        motor/{mne}/emergency_stop</span>
<span class="sd">            on(&quot;change&quot;): Sent when a motor controller indicates a hardware emergency stop.</span>
<span class="sd">            get: True if an emergency-stop switch or condition has been activated.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">motor_fault</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_readonly_property</span><span class="p">(</span><span class="s2">&quot;motor_fault&quot;</span><span class="p">,</span> <span class="nb">bool</span><span class="p">)</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        motor/{mne}/motor_fault</span>
<span class="sd">            on(&quot;change&quot;): Sent when a motor controller indicates a hardware motor fault.</span>
<span class="sd">            get: True if a motor-fault condition has been activated.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">high_limit</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_property</span><span class="p">(</span><span class="s2">&quot;high_limit&quot;</span><span class="p">,</span> <span class="nb">float</span><span class="p">)</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        motor/{mne}/high_limit</span>
<span class="sd">            on(&quot;change&quot;): Sent when the value of the high limit position changes.</span>
<span class="sd">            get: Returns the high limit in dial units.</span>
<span class="sd">            set: Sets the high limit by pushing</span>

<span class="sd">                .. code-block:: none</span>
<span class="sd">                </span>
<span class="sd">                    set_lm  mne data user(mne,get_lim(mne,-1))\\n</span>

<span class="sd">                onto the server command queue. (The last argument adds the current low limit to the set_lm command line.)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">low_limit</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_property</span><span class="p">(</span><span class="s2">&quot;low_limit&quot;</span><span class="p">,</span> <span class="nb">float</span><span class="p">)</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        motor/{mne}/low_limit</span>
<span class="sd">            on(&quot;change&quot;): Sent when the value of the low limit position changes.</span>
<span class="sd">            get: Returns the low limit in dial units.</span>
<span class="sd">            set: Sets the low limit by pushing</span>

<span class="sd">                .. code-block:: none</span>
<span class="sd">                </span>
<span class="sd">                    set_lm mne data user(mne,get_lim(mne,+1))\\n</span>

<span class="sd">            onto the server command queue. (The last argument adds the current high limit to the set_lm command line.)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_limits</span><span class="p">:</span> <span class="n">WritableProperty</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_writeonly_property</span><span class="p">(</span><span class="s2">&quot;limits&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        motor/{mne}/limits</span>
<span class="sd">            set: Sets both motor limits by pushing</span>

<span class="sd">                .. code-block:: none</span>
<span class="sd">                </span>
<span class="sd">                    set_lm mne data\\n</span>

<span class="sd">                onto the server command queue,</span>
<span class="sd">                where data should contain the low and high motor limit values in a string.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_search</span><span class="p">:</span> <span class="n">WritableProperty</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_writeonly_property</span><span class="p">(</span><span class="s2">&quot;search&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        motor/{mne}/search</span>
<span class="sd">            set: The server starts a home or limit search by pushing a</span>

<span class="sd">                .. code-block:: none</span>
<span class="sd">                </span>
<span class="sd">                    chg_dial(mne, how)\\n</span>

<span class="sd">                or a</span>
<span class="sd">                </span>
<span class="sd">                .. code-block:: none</span>
<span class="sd">                </span>
<span class="sd">                    chg_dial(mne, how, home_pos)\\n</span>

<span class="sd">                onto the command queue, depending on whether the data contains one or two arguments.</span>
<span class="sd">                The `how` argument is one of the strings recognized by chg_dial(),</span>
<span class="sd">                namely \&quot;home\&quot;, \&quot;home+\&quot;, \&quot;home-\&quot;, \&quot;lim+\&quot; or \&quot;lim-\&quot;.</span>
<span class="sd">                The optional home_pos is the home position in dial units.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">unusable</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_readonly_property</span><span class="p">(</span><span class="s2">&quot;unusable&quot;</span><span class="p">,</span> <span class="nb">bool</span><span class="p">)</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        motor/{mne}/unusable</span>
<span class="sd">            on(&quot;change&quot;): Sent when a &quot;disable&quot; option to motor_par() has changed the enabled/disabled state of a motor on the server.</span>
<span class="sd">            get: True if the motor is unusable.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Sync check is somewhat complicated.</span>
        <span class="c1"># This is effectively a request from the server to resolve a synchronization issue.</span>
        <span class="c1"># The server will send an event with the current and expected positions,</span>
        <span class="c1"># and then wait for a response from either the server keyboard or SOME client.</span>
        <span class="c1"># This is not implemented yet, and probably wont be. The use case here is very niche.</span>

        <span class="c1"># self.sync_check = self._property(&quot;sync_check&quot;, str)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_start_one</span><span class="p">:</span> <span class="n">WritableProperty</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_writeonly_property</span><span class="p">(</span><span class="s2">&quot;start_one&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        motor/mne/start_one</span>
<span class="sd">            set: If preceded by a prestart_all, adds a</span>

<span class="sd">                    </span>
<span class="sd">                .. code-block:: none</span>
<span class="sd">                </span>
<span class="sd">                    A[mne]=data;</span>

<span class="sd">                to the buffer that will be pushed onto the server command queue. Otherwise, pushes</span>

<span class="sd">                .. code-block:: none</span>
<span class="sd">                </span>
<span class="sd">                    {get_angles;A[mne]=data;move_em;}\\n</span>

<span class="sd">                onto the command queue in order to start the single motor moving.</span>
<span class="sd">        &quot;&quot;&quot;</span>

<div class="viewcode-block" id="Motor.move">
<a class="viewcode-back" href="../../../pyspec.client.html#pyspec.client._motor.Motor.move">[docs]</a>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">move</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">position</span><span class="p">:</span> <span class="nb">float</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Move the motor to the specified position.</span>

<span class="sd">        If motor synchronization is enabled, the move will be queued until synchronization is executed.</span>

<span class="sd">            Args:</span>
<span class="sd">                position (float): The target position to move the motor to.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_client_connection</span><span class="o">.</span><span class="n">_synchronizing_motors</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
                <span class="s2">&quot;Cannot start move when synchronizing motors. Use enqueue_move instead.&quot;</span>
            <span class="p">)</span>

        <span class="c1"># Start the tracking before we send the move to avoid race conditions.</span>
        <span class="k">async</span> <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">moving</span><span class="o">.</span><span class="n">subscribed</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">moving</span><span class="o">.</span><span class="n">wait_for</span><span class="p">(</span><span class="kc">False</span><span class="p">):</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_start_one</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">position</span><span class="p">)</span></div>


<div class="viewcode-block" id="Motor.start_move">
<a class="viewcode-back" href="../../../pyspec.client.html#pyspec.client._motor.Motor.start_move">[docs]</a>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">start_move</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">position</span><span class="p">:</span> <span class="nb">float</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Starts a move to the specified position.</span>
<span class="sd">        This will wait for the motor to start moving, and then return a task that can be awaited to wait for the move to complete.</span>

<span class="sd">        This is a convenience method that combines move() with waiting for the motor to start moving, which can be useful</span>
<span class="sd">        if you want to ensure that the motor is moving before moving on to other tasks.</span>
<span class="sd">            Args:</span>
<span class="sd">                position (float): The target position to move the motor to.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">async</span> <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">moving</span><span class="o">.</span><span class="n">wait_for</span><span class="p">(</span><span class="kc">True</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">create_task</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">move</span><span class="p">(</span><span class="n">position</span><span class="p">))</span></div>


<div class="viewcode-block" id="Motor.prepare_move">
<a class="viewcode-back" href="../../../pyspec.client.html#pyspec.client._motor.Motor.prepare_move">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">prepare_move</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">position</span><span class="p">:</span> <span class="nb">float</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Prepare a move to the specified position without starting it.</span>

<span class="sd">        This is used for motor synchronization, where multiple moves are queued and then executed together when synchronization is executed.</span>

<span class="sd">            Args:</span>
<span class="sd">                position (float): The target position to move the motor to.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_client_connection</span><span class="o">.</span><span class="n">_synchronizing_motors</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Cannot prepare move when not synchronizing motors&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_client_connection</span><span class="o">.</span><span class="n">_pending_motions</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">position</span></div>


    <span class="nd">@overload</span>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">search</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">how</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;home&quot;</span><span class="p">,</span> <span class="s2">&quot;home+&quot;</span><span class="p">,</span> <span class="s2">&quot;home-&quot;</span><span class="p">],</span> <span class="n">home_pos</span><span class="p">:</span> <span class="nb">float</span><span class="p">):</span> <span class="o">...</span>

    <span class="nd">@overload</span>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">search</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">how</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;lim+&quot;</span><span class="p">,</span> <span class="s2">&quot;lim-&quot;</span><span class="p">],</span> <span class="n">home_pos</span><span class="p">:</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span> <span class="o">...</span>
<div class="viewcode-block" id="Motor.search">
<a class="viewcode-back" href="../../../pyspec.client.html#pyspec.client._motor.Motor.search">[docs]</a>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">search</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">how</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;home&quot;</span><span class="p">,</span> <span class="s2">&quot;home+&quot;</span><span class="p">,</span> <span class="s2">&quot;home-&quot;</span><span class="p">,</span> <span class="s2">&quot;lim+&quot;</span><span class="p">,</span> <span class="s2">&quot;lim-&quot;</span><span class="p">],</span>
        <span class="n">home_pos</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Start a home or limit search.</span>

<span class="sd">        Pushes a chg_dial command like:</span>

<span class="sd">        .. code-block:: none</span>

<span class="sd">            chg_dial(mne, how)\n</span>
<span class="sd">                or</span>
<span class="sd">            chg_dial(mne, how, home_pos)\n</span>

<span class="sd">        Args:</span>
<span class="sd">            how (Literal[&quot;home&quot;, &quot;home+&quot;, &quot;home-&quot;, &quot;lim+&quot;, &quot;lim-&quot;]): The type of search to perform. Must be one of &quot;home&quot;, &quot;home+&quot;, &quot;home-&quot;, &quot;lim+&quot; or &quot;lim-&quot;.</span>
<span class="sd">            home_pos (Optional[float]): The home position in dial units (required for home searches).</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">how</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;home&quot;</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">home_pos</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;home_pos must be provided for home searches&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_search</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">how</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">home_pos</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_search</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">how</span><span class="p">)</span></div>


<div class="viewcode-block" id="Motor.set_limits">
<a class="viewcode-back" href="../../../pyspec.client.html#pyspec.client._motor.Motor.set_limits">[docs]</a>
    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">set_limits</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">low_limit</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">high_limit</span><span class="p">:</span> <span class="nb">float</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set both motor limits by pushing:</span>

<span class="sd">        .. code-block:: none</span>

<span class="sd">            set_lm mne data\n</span>

<span class="sd">        onto the server command queue, where data should contain the low and high motor limit values in a string.</span>

<span class="sd">        Args:</span>
<span class="sd">            low_limit (float): The low limit value.</span>
<span class="sd">            high_limit (float): The high limit value.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_limits</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">low_limit</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">high_limit</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span></div>
</div>

</pre></div>

            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>  
    <div class="related" role="navigation" aria-label="Related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
          <li><img src="../../../_static/py.svg" alt="Python logo" style="vertical-align: middle; margin-top: -1px"/></li>
          <li><a href="https://www.python.org/">Python</a> &#187;</li>
          <li class="switchers">
            <div class="language_switcher_placeholder"></div>
            <div class="version_switcher_placeholder"></div>
          </li>
          <li>
              
              <a href="../../../index.html">pyspec 0.1 documentation</a> &#187;
              
          </li>
          <li class="nav-item nav-item-1"><a href="../../index.html" >Module code</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">pyspec.client._motor</a></li>
                <li class="right">
                    

    <div class="inline-search" role="search">
        <form class="inline-search" action="../../../search.html" method="get">
          <input placeholder="Quick search" aria-label="Quick search" type="search" name="q" id="search-box" />
          <input type="submit" value="Go" />
        </form>
    </div>
                     |
                </li>
            <li class="right">
<label class="theme-selector-label">
    Theme
    <select class="theme-selector" oninput="activateTheme(this.value)">
        <option value="auto" selected>Auto</option>
        <option value="light">Light</option>
        <option value="dark">Dark</option>
    </select>
</label> |</li>
            
      </ul>
    </div>  
    <div class="footer">
    &copy; 
    Copyright
     .
    <br />
    This page is licensed under the Python Software Foundation License Version 2.
    <br />
    Examples, recipes, and other code in the documentation are additionally licensed under the Zero Clause BSD License.
    <br />
    
    
    <br />

    The Python Software Foundation is a non-profit corporation.
<a href="https://www.python.org/psf/donations/">Please donate.</a>
<br />
    <br />
    
    <br />

    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.1.3.
    </div>

  </body>
</html>